/*
Formalizr v. 1.0.0.3
Copyright (C) 2014-2019 www.dennisbabkin.com. All Rights Reserved.

This is an Open Source project. It is minified for efficiency.
To download readable source code, go to:
 https://github.com/dennisbabkin/Formalizr
*/

gl={oAccPages:{},gbIncogTab:false,gbShiftOn:false,gstrActvURL:"",gnTabID:null,localizeHtmlPage:function(){var c=document.getElementsByTagName("html");for(var a=0;a<c.length;a++){var d=c[a];var e=d.innerHTML.toString();var b=e.replace(/__MSG_(\w+)__/g,function(g,h){var f=h?chrome.i18n.getMessage(h):"";return f?f:(h?h:"")});if(b!=e){d.innerHTML=b}}},encodeHtml:function(a){return a.replace(/\"|\&|\n|\r|[\u00A0-\u9999<>\&]/gim,function(b){return"&#"+b.charCodeAt(0)+";"})},abbrevString:function(b,a){b=b?b.toString():"";if(a>=3&&b.length>a-3){b=b.substr(0,a-3)+"..."}return b},getAccordionHtml:function(u,l,h){var f="";var s=this.getCopyMemoryStorageObject();for(var i in this.oAccPages){delete this.oAccPages[i]}l=l?true:false;var j=false;u=u?u.toString().toLowerCase():"";var a=[];for(var o in s){a.push({pgUrl:o,tm:s[o].tm})}a.sort(function(p,m){return m.tm-p.tm});if(a.length>0){var d=this.encodeHtml(chrome.i18n.getMessage("prompt_OpenPage"));for(var g=0;g<a.length;g++){var t=a[g].pgUrl;var r=s[t];var n=r.flg&2?true:false;if(h==1){if(!l&&n){continue}}else{if(h==2){if(l!=n){continue}}}var e=g.toString();if(j===false){if(u==t.toLowerCase()){j=g}}var c=r.fav?r.fav:"chrome://favicon/"+t;f+='<h3 pgId="'+e+'"'+(n?' class="hdrAccrdIncg"':"")+'><img src="'+this.encodeHtml(c)+'" draggable="false" class="favIcn" />';var b=r.ttl;if(!b){b=t}var q=gl.abbrevString(b,128);f+='<div class="divTrunc"><span class="hdrPageTitle" title="'+this.encodeHtml(b)+'">'+this.encodeHtml(q)+"</span></div>";var k=this.encodeHtml(t);f+='<a class="hdrLink" draggable="false" href="'+k+'" title="'+k+'" target="_blank"></a>';f+="</h3>";f+="<div></div>";this.oAccPages[e]={avl:false,url:t,tms:null}}}return{htm:f,actv:j}},onOpenAccordionPage:function(r,N,L){try{var g=N.getAttribute("pgId");var O=this.oAccPages[g];if(O){if(!O.avl){var v=O.url;var k=this.getCopyMemoryStorageObject();var E=this.encodeHtml(chrome.i18n.getMessage("slider_latest"));var m=this.encodeHtml(chrome.i18n.getMessage("slider_oldest"));var I=this.encodeHtml(chrome.i18n.getMessage("lnk_copy"));var d=this.encodeHtml(chrome.i18n.getMessage("lnk_form_fill"));var s=this.encodeHtml(chrome.i18n.getMessage("lnk_copy_all"));var p=this.encodeHtml(chrome.i18n.getMessage("lnk_remove_page"));var C=this.encodeHtml(chrome.i18n.getMessage("msg_saved"));var A=this.encodeHtml(chrome.i18n.getMessage("msg_incognito"));var l=this.encodeHtml(chrome.i18n.getMessage("msg_more_txbxs_available"));var o=this.encodeHtml(chrome.i18n.getMessage("prompt_more_txbxs_available"));var q=k[v];var D=q.frms;var S=q.flg&2?true:false;var x="";var f=O.tms;if(!f){f=[];var n=0;for(var a in D){for(var J in D[a]){var B=D[a][J].tx;if(B.length>1){for(var Q=0;Q<B.length;Q++){if(f.indexOf(B[Q].tm)==-1){f.push(B[Q].tm)}}}else{if(B.length>0){if(B[0].tm>n){n=B[0].tm}}}}}if(f.length==0){f.push(n);if(!n){console.error("[318] Failed to find def_tm")}}f.sort(function(i,e){return e-i});O.tms=f}if(f.length>0){var G=O.tbxs;if(!G){G=[];for(var a in D){for(var J in D[a]){var b=D[a][J];var w=b.tx;var j=w.length>0?w[0].tm:0;for(var K=1;K<w.length;K++){if(w[K].tm>j){j=w[K].tm}}G.push({tm:j,tbxID:J,tbxGInd:gl.__gnTbxGIndCntr++,tbx:b})}}G.sort(function(i,e){return e.tm-i.tm});O.tbxs=G}if(G.length>0){x+='<div><div class="mainDiv">';if(S){x+='<span class="spnTopIncg">'+A+"</span>"}x+='<span class="spnTopLstSvd">'+C+" "+this.formatDateTimeFromTicks(this.convertFromUTCTicks(q.tm))+"</span>";x+='<div class="divTop">';x+='<div class="divTopSldr">';var P=f.length>1?"":" disabled";x+='<input type="button" id="idBtnLess_'+g+'" class="btnLess" value="&lt;"'+P+" />";x+='<input type="range" id="idRange_'+g+'" class="ctrlRange" min="0" value="0" max="'+(f.length-1)+'" step="1"'+P+" />";x+='<input type="button" id="idBtnMore_'+g+'" class="btnMore" value="&gt;"'+P+" />";x+='<div class="brk"></div><span class="lblLatest">'+E+'</span><span class="lblOldest">'+m+"</span></div>";x+='<div class="divTopTb">';x+='<a href="#" id="idFormFill_'+g+'" draggable="false" class="smtbBtnFill smtbBtn" title="'+d+'"></a>';x+='<a href="#" id="idCopyAll_'+g+'" draggable="false" class="smtbBtnCopy smtbBtn" title="'+s+'"></a>';x+='<a href="#" id="idRemPg_'+g+'" draggable="false" class="smtbBtnRem smtbBtn" title="'+p+'"></a>';x+="</div>";x+="</div>";for(var M=0;M<G.length;M++){var J=G[M].tbxID;var b=G[M].tbx;var H=G[M].tbxGInd;var u=this.encodeHtml(J+b.si.toString()+H.toString());x+='<div class="ctrlDiv">';var c=b.nm;if(!c){c=b.id}x+='<span class="ctrlName">'+this.encodeHtml(this.abbrevString(c,64))+"</span>";var z=gl._lookupBestMatchTxTm(0,f,b.tx);var h=z?z.txt:null;var T=z&&z.tm?z.tm:0;var F=h?this.encodeHtml(h):"";if(!this.isLikeTextarea(b.tp)){x+='<input type="text" id="idTbx_'+g+"_"+u+'" value="'+F+'" readonly />'}else{x+='<textarea id="idTA_'+g+"_"+u+'" rows="4" readonly>'+F+"</textarea>"}x+='<a href="#" draggable="false" class="lnkCopy" id="idCopy_'+g+"_"+u+'">'+I+"</a>";x+='<span class="ctrlSaved" id="idTmSvd_'+g+"_"+u+'">'+C+" "+this.formatDateTimeFromTicks(this.convertFromUTCTicks(T))+"</span>";x+="</div>"}if(q.flg&1){x+='<div class="ctrlDivMoreAvl"><a class="ctrlMoreAvlSttgsLnk" href="#" title="'+o+'">'+l+"</a></div>"}x+="</div></div>"}else{gl.logError("[255] ERR:TxBxs, url="+v);x='<p style="color: red;">'+this.encodeHtml(chrome.i18n.getMessage("msg_err_contents01"))+"</p>"}}else{gl.logError("[243] ERR:Times, url="+v);x='<p style="color: red;">'+this.encodeHtml(chrome.i18n.getMessage("msg_err_contents01"))+"</p>"}L.innerHTML=x;gl.addAccordionEventHandlersForPage(g);O.avl=true}}else{gl.logError("[242] ERROR: Tab "+(r?"created":"opened")+" pgId="+g+", id="+N.id+", panel="+L.id)}}catch(R){gl.logExceptionReport(241,R)}},__gnTbxGIndCntr:0,onCloseAccordionPage:function(b,c){var a=b.getAttribute("pgId")},updateAccordionCtrls:function(d,l){try{var p=this.oAccPages[d];if(p){l=parseInt(l,10);var h=p.tms;if(l>=0&&l<h.length){var s=this.getCopyMemoryStorageObject();var n=this.encodeHtml(chrome.i18n.getMessage("msg_saved"));var o=s[p.url];if(o){var f=p.tbxs;for(var j=0;j<f.length;j++){var g=f[j].tbxID;var b=f[j].tbx;var c=f[j].tbxGInd;var a=this.encodeHtml(g+b.si.toString()+c.toString());var i=(!this.isLikeTextarea(b.tp)?"idTbx_":"idTA_")+d+"_"+a;var k=document.getElementById(i);if(k){var q=this._lookupBestMatchTxTm(l,h,b.tx);k.value=q.txt?q.txt:"";var m=document.getElementById("idTmSvd_"+d+"_"+a);if(m){m.innerText=n+" "+(q.tm!==null?this.formatDateTimeFromTicks(this.convertFromUTCTicks(q.tm)):"")}}else{console.error("[315] Bad pageID="+d+", tp="+b.tp)}}}}}}catch(r){gl.logExceptionReport(110,r)}},isLikeTextarea:function(a){return a=="textarea"||a==">ce"},addToolbarEventHandlers:function(){document.getElementById("tbBtnOnOff").onclick=function(c){if(!c.shiftKey){gl.onOff()}else{var d=gl.getSettingsRef();var a=d.bCollectData;if(a&&gl.gbIncogTab&&!d.bIncogCollectData){a=false}if(a){var b=gl.isTabDataCollected();if(b===true){if(!gl.isCmdOrCtrlKey(c)){gl.toggleException(gl.gstrActvURL,0,true)}else{gl.toggleException(gl.gstrActvURL,1,true)}}else{return false}}else{return false}}window.close();return false};document.getElementById("tbBtnSettings").onclick=function(a){if(!a.shiftKey){gl.showOptions()}else{gl.showOptions("tabExceptions")}return false};document.getElementById("tbBtnInfo").onclick=function(a){if(!a.shiftKey){gl.showInfoWindow(true)}else{gl.showInfoWindow(true,"tabFeedback")}return false}},isCmdOrCtrlKey:function(a){return a.metaKey||a.ctrlKey?true:false},getLastVisitedURL:function(){var a=chrome.extension.getBackgroundPage();return a.gl.getLastVisitedURL()},addPageEventHandlers:function(){$(window).resize(function(){var b=gl.getPageZoom();var a=b*100;a=~~a;if(window.__formlzr_izoom&&a!=window.__formlzr_izoom){console.log("[208] Automatically closing popup after detecting zooming. Zoom before="+window.__formlzr_izoom+", zoom now="+a);window.close()}window.__formlzr_izoom=a})},addAccordionEventHandlersForPage:function(c){var x=this.getCopyMemoryStorageObject();var g=document.getElementById("idBtnLess_"+c);if(g){g.frmlzr_pgID=c;g.addEventListener("click",function(t){gl.onSliderBtnLess(t.target.frmlzr_pgID)})}var u=document.getElementById("idBtnMore_"+c);if(u){u.frmlzr_pgID=c;u.addEventListener("click",function(t){gl.onSliderBtnMore(t.target.frmlzr_pgID)})}var a="idRange_"+c;var q=document.getElementById(a);if(q){q.frmlzr_pgID=c;q.frmlzr_sliderID=a;q.addEventListener("input",function(A){var z=A.target;gl.onSliderPosChanged(z.frmlzr_pgID,z.frmlzr_sliderID)})}var o="idFormFill_"+c;var d=document.getElementById(o);if(d){d.frmlzr_pgID=c;d.addEventListener("click",function(t){gl.onPageTbButton_FormFill(t.target.frmlzr_pgID,t);t.preventDefault();return false})}var m="idCopyAll_"+c;var w=document.getElementById(m);if(w){w.frmlzr_pgID=c;w.addEventListener("click",function(t){gl.onPageTbButton_CopyAll(t.target.frmlzr_pgID,t);t.preventDefault();return false})}var v="idRemPg_"+c;var n=document.getElementById(v);if(n){n.frmlzr_pgID=c;n.addEventListener("click",function(t){gl.onPageTbButton_RemovePage(t.target.frmlzr_pgID,t);t.preventDefault();return false})}var s=this.oAccPages[c];var r=x[s.url];if(r){var h=s.tbxs;for(var l=0;l<h.length;l++){var i=h[l].tbxID;var f=h[l].tbx;var e=h[l].tbxGInd;var b=this.encodeHtml(i+f.si.toString()+e.toString());var p="idCopy_"+c+"_"+b;var y=document.getElementById(p);if(y){var j=(!this.isLikeTextarea(f.tp)?"idTbx_":"idTA_")+c+"_"+b;var k=document.getElementById(j);if(k){y.frmlzr_pgID=c;y.frmlzr_lnkID=p;y.frmlzr_textBxID=j;y.frmlzr_tp=p;y.addEventListener("click",function(t){l=t.target;gl.onItemCopyClicked(l.frmlzr_pgID,l.frmlzr_lnkID,l.frmlzr_textBxID,l.frmlzr_tp);t.preventDefault();return false})}else{console.error("[317] Bad textBxID="+j)}}else{console.error("[316] Bad copy link, lnkID="+p)}}}$(".ctrlMoreAvlSttgsLnk").click(function(t){t.preventDefault();gl.showOptions("tabMemory")})},onSliderBtnLess:function(a){var b=document.getElementById("idRange_"+a);if(b){var c=b.value;if(c>0){c--}else{c=0}if(c>=0){b.value=c;this.updateAccordionCtrls(a,c)}}},onSliderBtnMore:function(a){var b=document.getElementById("idRange_"+a);if(b){var d=b.value;var c=this.oAccPages[a];if(d<c.tms.length){d++}else{d=c.tms.length-1}if(d>=0){b.value=d;this.updateAccordionCtrls(a,d)}}},onSliderPosChanged:function(b,a){var c=document.getElementById(a);if(c){var d=c.value;this.updateAccordionCtrls(b,d)}},onPageTbButton_CopyAll:function(d,u){var q="";try{var s=this.oAccPages[d];if(s){var x=this.getCopyMemoryStorageObject();var r=x[s.url];if(r){var g=this.getNewLine();var j=!!u.shiftKey;var p=chrome.i18n.getMessage("msg_saved");var a=chrome.i18n.getMessage("msg_more_txbxs_available");if(r.ttl){q+='"'+r.ttl+'"'+g}if(s.url){q+=s.url+g}if(j){if(r.fav){q+="FavIcon: "+r.fav+g}q+="Flgs: 0x"+r.flg.toString(16)+g}q+=p+" "+(r.tm!==null?this.formatDateTimeFromTicks(this.convertFromUTCTicks(r.tm)):"")+g;q+=g;var n=document.getElementById("idRange_"+d);if(n){var l=parseInt(n.value,10);var i=s.tms;if(i&&l>=0&&l<i.length){if(!j){var f=s.tbxs;if(f&&f.length>0){for(var k=0;k<f.length;k++){var c=f[k].tbx;var v=this._lookupBestMatchTxTm(l,i,c.tx);q+="-------------------------------"+g;var o=c.nm;if(!o){o=c.id}if(o){q+="["+o+"]"+g}q+=p+" "+(v.tm!==null?this.formatDateTimeFromTicks(this.convertFromUTCTicks(v.tm)):"")+g;q+=g;q+=v.txt?this.replaceNewLines(v.txt):"";q+=g+g}}}else{for(var m in r.frms){var b=gl.extractIframeInfo(m);q+="+++++++++++++++++++++++++++++++"+g;q+="IFrame: "+b.url+g;if(b.idx){q+="IIndex: "+b.idx+g}q+=g;for(var h in r.frms[m]){var c=r.frms[m][h];var v=this._lookupBestMatchTxTm(l,i,c.tx);q+="-------------------------------"+g;q+='ID: "'+(c.id?c.id:"")+'"'+g;q+='Name: "'+(c.nm?c.nm:"")+'"'+g;q+='TbxId: "'+h+'"'+g;q+='Type: "'+(c.tp?c.tp:"")+'"'+g;q+="OSI: 0x"+c.osi.toString(16)+g;q+="SI: 0x"+c.si.toString(16)+g;q+=p+" "+(v.tm!==null?this.formatDateTimeFromTicks(this.convertFromUTCTicks(v.tm)):"")+g;q+=g;q+=v.txt?this.replaceNewLines(v.txt):"";q+=g+g}}}if(r.flg&1){q+="!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!"+g;q+=a+g}if(this.clipboardCopyText(q,false)){}}}}}}catch(w){gl.logExceptionReport(114,w)}},onPageTbButton_FormFill:function(a,b){var f="";try{var d=chrome.extension.getBackgroundPage();d.gl.updateInfoFromActiveTab(function(){var n=gl.oAccPages[a];if(n){var e=gl.getCopyMemoryStorageObject();var h=e[n.url];if(h){var i=document.getElementById("idRange_"+a);if(i){var l=parseInt(i.value,10);var m=n.tms;if(l>=0&&l<m.length){var k={};for(var g in h.frms){var j;if(!(g in k)){j=[];k[g]=j}else{j=k[g]}for(var p in h.frms[g]){var q=h.frms[g][p];var o=gl._lookupBestMatchTxTm(l,m,q.tx);j.push({si:q.osi,id:q.id?q.id.toString():"",nm:q.nm?q.nm.toString():"",tp:q.tp?q.tp.toString():"",v:o.txt?o.txt.toString():""})}}d.gl.fillAllFormData(k)}}}}})}catch(c){gl.logExceptionReport(122,c)}},onPageTbButton_RemovePage:function(a,b){gl.showModalPrompt_OKCancel(chrome.i18n.getMessage("msg_pg_remove"),chrome.i18n.getMessage("msg_title_pg_remove"),chrome.i18n.getMessage("btn_remove"),chrome.i18n.getMessage("btn_cancel"),this.onRemovePagaData,{pageID:a,event:b})},onRemovePagaData:function(c){try{var a=c.pageID;var b=gl.oAccPages[a];if(b){var f=gl.getMemoryStorageObjectRef();if(b.url in f){$("#accordion").accordion("destroy");delete f[b.url];delete gl.oAccPages[a];gl.resetCopyMemoryStorageObject(true);gl.createAccordion("");gl.updateOptionsPage()}}}catch(d){gl.logExceptionReport(118,d)}},onItemCopyClicked:function(a,b,f,c){var e=document.getElementById(f);if(e){if(this.clipboardCopyText(e.value,true)){var d=document.getElementById(b);if(d){d.innerText=gl.encodeHtml(chrome.i18n.getMessage("lnk_done"));setTimeout(function(){d.innerText=gl.encodeHtml(chrome.i18n.getMessage("lnk_copy"))},900)}}}},logReport:function(a){var b=chrome.extension.getBackgroundPage();b.gl.logReport(a)},logWarning:function(a){var b=chrome.extension.getBackgroundPage();b.gl.logWarning(a)},logError:function(a){var b=chrome.extension.getBackgroundPage();b.gl.logError(a)},logExceptionReport:function(c,a){var b=chrome.extension.getBackgroundPage();b.gl.logExceptionReport(c,a)},overrideConsole:function(){if(!gl._fnConsoleLog){gl._fnConsoleLog=console.log;console.log=function(){gl._fnConsoleLog.apply(console,arguments);if(arguments.length>0){gl.logReport(arguments[0])}}}if(!gl._fnConsoleWarn){gl._fnConsoleWarn=console.warn;console.warn=function(){gl._fnConsoleWarn.apply(console,arguments);if(arguments.length>0){gl.logWarning(arguments[0])}}}if(!gl._fnConsoleErr){gl._fnConsoleErr=console.error;console.error=function(){gl._fnConsoleErr.apply(console,arguments);if(arguments.length>0){gl.logError(arguments[0])}}}},_fnConsoleLog:null,_fnConsoleWarn:null,_fnConsoleErr:null,_lookupBestMatchTxTm:function(e,c,f){var a=null;var b=null;for(var d=e;d<c.length;d++){a=this._getTextForTm(f,c[d]);if(a){b=c[d];break}}if(!a){for(var d=e-1;d>=0;d--){a=this._getTextForTm(f,c[d]);if(a){b=c[d];break}}}if(!a){if(f.length>0){a=f[0].v;b=f[0].tm}if(f.length!=1){console.error("[319] Bad index, nIndexTime="+e+", arrTms_Len="+c.length+", arrTx_Len="+f.length)}}return{txt:a,tm:b}},_getTextForTm:function(a,b){for(var c=0;c<a.length;c++){if(a[c].tm==b){return a[c].v}}return null},getSettingsRef:function(){var a=chrome.extension.getBackgroundPage();return a.gl.gSettings},getPlatformType:function(){var a=chrome.extension.getBackgroundPage();return a.gl.gPlatform},isTabDataCollected:function(b){var a=chrome.extension.getBackgroundPage();return a.gl.isTabDataCollected(b!==null&&b!==undefined?b:gl.gnTabID)},getNewLine:function(){var a=this.getSettingsRef().nCopySubstNewLines;if(a==1){return"\r\n"}else{if(a==2){return"\n"}else{if(a==3){return"\r"}}}switch(this.getPlatformType()){case 1:case 3:return"\n";case 2:return"\r\n"}return"\n"},replaceNewLines:function(b){var a=chrome.extension.getBackgroundPage();return a.gl.replaceNewLines(b)},clipboardCopyText:function(d,b){try{var a=false;if(!d){d=""}if(b!==false){d=this.replaceNewLines(d)}document.oncopy=function(f){try{f.clipboardData.setData("Text",d.toString());f.preventDefault();a=true}catch(g){gl.logExceptionReport(312,g)}};document.execCommand("Copy",false,null);document.oncopy=undefined;return a}catch(c){gl.logExceptionReport(109,c);return false}},convertFromUTCTicks:function(a){return a-new Date().getTimezoneOffset()*60000},formatDateTimeFromTicks:function(a){return new Date(a).toLocaleString()},formatDateFromTicks:function(a){return new Date(a).toLocaleDateString()},formatTimeFromTicks:function(a){return new Date(a).toLocaleTimeString()},getMemoryStorageObjectRef:function(){var a=chrome.extension.getBackgroundPage();return a.gl.oStorage},__gcpyMemStg:null,getCopyMemoryStorageObject:function(){if(!this.__gcpyMemStg){var a=chrome.extension.getBackgroundPage();this.__gcpyMemStg=$.extend(true,{},a.gl.oStorage)}return this.__gcpyMemStg},resetCopyMemoryStorageObject:function(a){this.__gcpyMemStg=null;if(a){var b=chrome.extension.getBackgroundPage();b.gl.onPersistentSaveStorage(true)}},showModalPrompt_OKCancel:function(d,b,g,f,h,c){var a=false;try{$("#dialog-confirm-msgtxt").html(d.replace(/\n/g,"<br />"));$("#dialog-confirm").dialog({resizable:false,height:"auto",modal:true,title:b,buttons:[{text:g,click:function(){$(this).dialog("close");if(h){h(c)}}},{text:f,click:function(){$(this).dialog("close")}}]});a=true}catch(i){gl.logExceptionReport(117,i);a=false}return a},createAccordion:function(j){var o=gl.gbIncogTab;var m=gl.getSettingsRef();var c=document.getElementById("accordion");var e=gl.getAccordionHtml(j,o,m.nViewIncogData);if(!(c.innerHTML=e.htm)){document.getElementById("mainSection").innerHTML='<span class="spnNoData">'+gl.encodeHtml(chrome.i18n.getMessage("msg_no_data"))+"</span>"}var a=gl.getPlatformType()!=1;$("#accordion").accordion({animate:a?undefined:false,collapsible:true,heightStyle:"content",active:e.actv,create:function(s,r){if(r.panel.length>0){var q=r.panel[0];var p=r.header[0];gl.onOpenAccordionPage(true,p,q)}},beforeActivate:function(s,r){if(r.newPanel.length>0){var q=r.newPanel[0];var p=r.newHeader[0];gl.onOpenAccordionPage(false,p,q)}},activate:function(C,z){if(z.oldPanel.length>0){var x=z.oldPanel[0];var A=z.oldHeader[0];gl.onCloseAccordionPage(A,x)}if(z&&z.newHeader&&z.newPanel){if(z.newHeader.length>0&&z.newPanel.length>0){var v=z.newHeader.offset();var y=z.newHeader.outerHeight(false);var B=z.newPanel.offset();var D=z.newPanel.outerHeight(true);var q=$("#mainSection");var u=q.offset();var t=q.outerHeight(true);var r=B.top+D-u.top;var p=v.top-u.top;var s=q.scrollTop();if(r+4>t){var w=r+4-t;if(p-w<0){w=p}q.animate({scrollTop:w+s},100)}else{if(p<0){q.animate({scrollTop:p-4+s},100)}}}}}});$(".hdrLink").click(function(p){p.stopPropagation();var r=o;if(p.shiftKey){r=r?false:true}if(r){p.preventDefault();var q=$(this).attr("href");chrome.windows.create({url:q,incognito:true})}});if(gl.isInt(e.actv)){var l=$(".ui-accordion-header-active");var h=l.offset();var i=l.outerHeight(false);var d=l.scrollTop();var b=$("#mainSection");var g=b.offset();var f=b.outerHeight(true);var k=h.top-g.top-d+i;var n=f*1/3;if(k>n){b.animate({scrollTop:k-n+b.scrollTop()},100)}}},isInt:function(a){return !isNaN(a)&&parseInt(Number(a))==a&&!isNaN(parseInt(a,10))},onOff:function(){gl.enableDataCollection(gl.getSettingsRef().bCollectData?false:true)},setOnOffButton:function(){var a=gl.getSettingsRef();var c=$("#tbBtnOnOff");var b=$("body");var e=true;if(gl.gbIncogTab&&!a.bIncogCollectData){e=false}if(e){c.show();var d=a.bCollectData;c.removeClass("toolbarBtnOn toolbarBtn");c.removeClass("toolbarBtnOff toolbarBtn");if(d){c.addClass("toolbarBtnOn toolbarBtn");c.attr("title",this.encodeHtml(chrome.i18n.getMessage("promptToolbarButton_On")));b.removeClass("bkgndDsbld")}else{c.addClass("toolbarBtnOff toolbarBtn");c.attr("title",this.encodeHtml(chrome.i18n.getMessage("promptToolbarButton_Off")));b.addClass("bkgndDsbld")}}else{c.hide();b.addClass("bkgndDsbld")}},enableDataCollection:function(a){var b=chrome.extension.getBackgroundPage();b.gl.enableDataCollection(a?true:false);gl.setOnOffButton();b.gl.updateActiveTabIconAndBadge()},showOptions:function(a){var b=chrome.extension.getBackgroundPage();b.gl.openAppSettingsWindow(a);window.close()},showInfoWindow:function(a,b){var c=chrome.extension.getBackgroundPage();c.gl.openAppInfoWindow(b);if(a===true){window.close()}},getPageZoom:function(){var b=1;try{var a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttribute("xmlns","http://www.w3.org/2000/svg");a.setAttribute("version","1.1");document.body.appendChild(a);b=a.currentScale;document.body.removeChild(a)}catch(c){gl.logExceptionReport(210,c)}return b},updateOptionsPage:function(){var a=chrome.extension.getBackgroundPage();a.gl.updateOptionsPage()},extractIframeInfo:function(b){var d="";var c="";if(b){var a=b.match(/([\d_]+)\>(.*)/);if(a&&a.length==3){c=a[1];d=a[2]}else{d=b}}return{url:d,idx:c}},toggleException:function(a,d,b){var c=chrome.extension.getBackgroundPage();c.gl.toggleException(a,d,b)},setShiftKeyTracking:function(){window.addEventListener("keydown",function(a){gl.gbShiftOn=a.shiftKey});window.addEventListener("keyup",function(a){gl.gbShiftOn=a.shiftKey})},adjustMainSectionHeight:function(){var i=$("#mainSection");var a=i.offset();var c=$(window);var j=gl.getPageZoom();if(j===null||j===undefined){j=1}var b=i.outerHeight();b*=j;var f=a.top;f*=j;var k=c.height();k*=j;var e=f+b;var h=k-e;var d=600-f-h-10*j;var g=d/j;g=~~g;i.css("max-height",g+"px")}};gl.overrideConsole();gl.localizeHtmlPage();if(!gl.getSettingsRef().bUseNativeScrollbars){$("head").append('<link rel="stylesheet" href="popup_scrlbrs.css" type="text/css">')}gl.setShiftKeyTracking();var port=chrome.runtime.connect({name:"port_popup"});port.postMessage({action:"init"});gl.adjustMainSectionHeight();chrome.tabs.query({active:true,currentWindow:true},function(a){var d=chrome.extension.getBackgroundPage();var b=a.length>0?a[0]:null;var c=b?b.url:"";gl.gnTabID=b.id;gl.gstrActvURL=c;gl.gbIncogTab=b?b.incognito:false;gl.setOnOffButton();$("#idPopupLogo").attr("src",!gl.gbIncogTab?"images/app-logo_med.png":"images/app-logo_med_incog.png");gl.addToolbarEventHandlers();d.gl.updateInfoFromTab(b?b.id:null);window.setTimeout(function(){$("#initSpnr").remove();gl.addPageEventHandlers();gl.createAccordion(c)},50)});