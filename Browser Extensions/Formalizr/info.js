/*
Formalizr v. 1.0.0.3
Copyright (C) 2014-2019 www.dennisbabkin.com. All Rights Reserved.

This is an Open Source project. It is minified for efficiency.
To download readable source code, go to:
 https://github.com/dennisbabkin/Formalizr
*/

gl={gnThisTabID:null,gstrSelTabId:null,localizeHtmlPage:function(){var c=document.getElementsByTagName("html");for(var a=0;a<c.length;a++){var d=c[a];var e=d.innerHTML.toString();var b=e.replace(/__MSG_(\w+)__/g,function(g,h){var f=h?chrome.i18n.getMessage(h):"";return f?f:(h?h:"")});if(b!=e){d.innerHTML=b}}},makeNonDraggable:function(){$("a").each(function(a){var b=$(this);b.attr("draggable",false)});$("img").each(function(a){var b=$(this);b.attr("draggable",false)})},logExceptionReport:function(c,a){var b=chrome.extension.getBackgroundPage();b.gl.logExceptionReport(c,a)},logReport:function(a){var b=chrome.extension.getBackgroundPage();b.gl.logReport(a)},logWarning:function(a){var b=chrome.extension.getBackgroundPage();b.gl.logWarning(a)},logError:function(a){var b=chrome.extension.getBackgroundPage();b.gl.logError(a)},overrideConsole:function(){if(!gl._fnConsoleLog){gl._fnConsoleLog=console.log;console.log=function(){gl._fnConsoleLog.apply(console,arguments);if(arguments.length>0){gl.logReport(arguments[0])}}}if(!gl._fnConsoleWarn){gl._fnConsoleWarn=console.warn;console.warn=function(){gl._fnConsoleWarn.apply(console,arguments);if(arguments.length>0){gl.logWarning(arguments[0])}}}if(!gl._fnConsoleErr){gl._fnConsoleErr=console.error;console.error=function(){gl._fnConsoleErr.apply(console,arguments);if(arguments.length>0){gl.logError(arguments[0])}}}},_fnConsoleLog:null,_fnConsoleWarn:null,_fnConsoleErr:null,encodeHtml:function(a){var b=chrome.extension.getBackgroundPage();return b.gl.encodeHtml(a)},abbrevString:function(c,a){var b=chrome.extension.getBackgroundPage();return b.gl.abbrevString(c,a)},isInt:function(a){var b=chrome.extension.getBackgroundPage();return b.gl.isInt(a)},clipboardCopyText:function(d,b){try{var a=false;if(!d){d=""}if(b!==false){d=this.replaceNewLines(d)}document.oncopy=function(f){try{f.clipboardData.setData("Text",d.toString());f.preventDefault();a=true}catch(g){gl.logExceptionReport(310,g)}};document.execCommand("Copy",false,null);document.oncopy=undefined;return a}catch(c){gl.logExceptionReport(290,c);return false}},replaceNewLines:function(b){var a=chrome.extension.getBackgroundPage();return a.gl.replaceNewLines(b)},getSettingsRef:function(){var a=chrome.extension.getBackgroundPage();return a.gl.gSettings},getThisAppName:function(){var a=chrome.extension.getBackgroundPage();return a.gl.gstrAppName},getThisAppVersion:function(){var a=chrome.extension.getBackgroundPage();return a.gl.getThisAppVersion()},onCheckForUpdates:function(a){if(!a.bUpdateAvail){console.log("[250] Checking for updates");var c=$("#"+a.id);c.fadeOut({duration:200,complete:function(){chrome.runtime.requestUpdateCheck(function(d,f){console.log("[252] Update check result: "+d+", v="+f.version);d=d?d.toString().toLowerCase():"";var e;switch(d){case"no_update":a.bUpdateAvail=false;c.attr("style","color: #bababa !important");e=chrome.i18n.getMessage("msg_no_update");break;case"update_available":a.bUpdateAvail=true;c.attr("style","color: #01ca2b !important");e=chrome.i18n.getMessage("msg_yes_update").replace("#V#",f.version?f.version:"?");break;default:a.bUpdateAvail=false;c.attr("style","color: #ca0101 !important");e=chrome.i18n.getMessage("msg_err_update");break}c.text(e);c.attr("title",gl.encodeHtml(e));c.fadeIn()})}})}else{console.log("[251] Manually reloading to install update");var b=chrome.extension.getBackgroundPage();b.gl.onInstallUpdate()}},getLastVisitedURL:function(){var a=chrome.extension.getBackgroundPage();return a.gl.getLastVisitedURL()},getUrlParams:function(a){var b=chrome.extension.getBackgroundPage();return b.gl.getUrlParams(a)},getSettingsExport:function(a,d,b,c){var e=chrome.extension.getBackgroundPage();e.gl.getSettingsExport(a,d,b,c)},openURL:function(a){var b=chrome.extension.getBackgroundPage();return b.gl.openURL(a)},openPageIfNotOpened:function(a,c){var b=chrome.extension.getBackgroundPage();return b.gl.openPageIfNotOpened(a,c)},openFAQPageIfNotOpened:function(a){var b=chrome.extension.getBackgroundPage();return b.gl.openFAQPageIfNotOpened(a)},openContactPageIfNotOpened:function(a,c){var b=chrome.extension.getBackgroundPage();return b.gl.openContactPageIfNotOpened(a,c)},getTabIndexByDomID:function(b){var a=$('#tabs a[href="'+b+'"]').parent().index();return a},getTabDomIDByIndex:function(a){return $("#tabs ul>li>a").eq(a).attr("href")},getSupportedLangIDs:function(c,a,b){var d=chrome.extension.getBackgroundPage();return d.gl.getSupportedLangIDs(c,a,b)},getAcceptedLangIDs:function(a){var b=chrome.extension.getBackgroundPage();return b.gl.getAcceptedLangIDs(a)},getLangEngNameByLangID:function(b){var a=chrome.extension.getBackgroundPage();return a.gl.getLangEngNameByLangID(b)},getFullUILangList:function(){var a=chrome.extension.getBackgroundPage();return a.gl.getFullUILangList()},onTabSelected:function(b,c){var a=gl.getTabDomIDByIndex(b);switch(a){case"#tabAbout":gl.onTabSelected_About();break;case"#tabManual":gl.onTabSelected_Manual();break;case"#tabTranslate":gl.onTabSelected_Translate();break;case"#tabFeedback":gl.onTabSelected_Feedback();break;default:console.error("[253] No handler for tab `"+a+"`, index="+b);break}gl.gstrSelTabId=a},onTabSelected_About:function(){gl.updateTabCtrls_About()},onTabSelected_Manual:function(){gl.updateTabCtrls_Manual()},onTabSelected_Translate:function(){gl.updateTabCtrls_Translate()},onTabSelected_Feedback:function(){gl.updateTabCtrls_Feedback()},updateTabCtrls:function(){switch(gl.gstrSelTabId){case"#tabAbout":gl.updateTabCtrls_About();break;case"#tabManual":gl.updateTabCtrls_Manual();break;case"#tabTranslate":gl.updateTabCtrls_Translate();break;case"#tabFeedback":gl.updateTabCtrls_Feedback();break;default:console.error("[254] No handler for tab '"+gl.gstrSelTabId+"'");break}},updateTabCtrls_About:function(){},updateTabCtrls_Manual:function(){if(!gl._gbUpdtdManualTab){gl._gbUpdtdManualTab=true;$("img",$("#idManTxt01")).each(function(b){var c=$(this);c.attr("draggable",false);var a=c.attr("id");if(a&&!c.attr("src")){c.attr("src","images/"+a+".png")}})}},_gbUpdtdManualTab:null,updateTabCtrls_Translate:function(){if(!gl._gbUpdtdTranslateTab){var a=$("#idLangsExsting");var b=$("#idLangsAvail");a.empty();b.empty();gl.getSupportedLangIDs(function(d,c){if(d===true){gl.getAcceptedLangIDs(function(g){gl._gbUpdtdTranslateTab=true;var q=null;var h=null;for(var j=0;j<c.length;j++){q=c[j];if(q){var p="";if(!h){for(var r=0;r<g.length;r++){if(g[r]==q){p=" selected";break}}}var k=gl.getLangEngNameByLangID(q);a.append('<option value="'+gl.encodeHtml(q)+'"'+p+">"+gl.encodeHtml(k?k:"["+q+"]")+"</option>")}}var f=gl.getFullUILangList();var m=[];for(var e in f){var n=false;for(var o=0;o<c.length;o++){var l=c[o];if(l){l=l.toLowerCase();if(l==e){n=true;break}}}if(!n){m.push({id:e,nm:gl.getLangEngNameByLangID(e)})}}m.sort(function(s,i){if(s.nm>i.nm){return 1}else{if(s.nm<i.nm){return -1}else{return 0}}});for(var j=0;j<m.length;j++){var e=m[j].id;var k=m[j].nm;b.append('<option value="'+gl.encodeHtml(e)+'">'+gl.encodeHtml(k?k:"["+e+"]")+"</option>")}})}else{gl.logError("[297] ERR: "+d)}},true,true)}},_gbUpdtdTranslateTab:null,onLinkTranslateContactUs:function(){var a=$("#idLangsAvail").val();gl.openContactPageIfNotOpened(false,"REQUEST: UI Translation\nREQUEST LANGID: ["+a+"] "+gl.getLangEngNameByLangID(a))},onLinkBugReportContactUs:function(b){var c=$("#idReportBugURL").val();c=c?c.toString().trim():"";var a='REQUEST: Bug report\nREPORT URL: "'+c+'"';if(b!==true){gl.openContactPageIfNotOpened(true,a)}else{gl.getSettingsExport("sttgsObjReport",2,true,function(d){var e=false;if(d!==null){a=d+"\n\n=================================\n"+a}else{console.error("[314] ERR: Failed to collect full report")}gl.openContactPageIfNotOpened(true,a)})}},_collectBugReport:function(b,a){try{gl.getSettingsExport("sttgsObjReport",b,true,function(d){var e=false;if(d!==null){if(gl.clipboardCopyText(d,true)){e=true}}if(a){a(e)}})}catch(c){gl.logExceptionReport(305,c);if(a){a(false)}}},onLinkCollectBugReport:function(a){gl._collectBugReport(a?2:1,function(d){var c="";var b="";if(d){c="copyReportOK";b=chrome.i18n.getMessage("msg_copied_ok")}else{c="copyReportErr";b=chrome.i18n.getMessage("msg_collect_err")}var e=$("#idReportConf");e.attr("class",c);e.text(b);window.setTimeout(function(){$("#idReportConf").text("")},5000)})},updateTabCtrls_Feedback:function(){},onShowLegalWindow:function(){var a=chrome.i18n.getMessage("txtLegal");$("#dialog-legal-msgbdy").html('<div id="divTaLegal"><textarea id="idTaLegal" readonly>'+gl.encodeHtml(a)+"</textarea></div>");$("#dialog-legal").dialog({resizable:true,height:"auto",width:640,height:500,minWidth:562,minHeight:300,modal:true,title:chrome.i18n.getMessage("msg_lgndLegal"),buttons:[{text:chrome.i18n.getMessage("lnk_copy"),click:function(){if(gl.clipboardCopyText(a,true)){$(this).dialog("close")}}},{text:chrome.i18n.getMessage("lnk_close"),click:function(){$(this).dialog("close")}}]})},onLinkClicked:function(c,a){a.stopPropagation();a.preventDefault();var g=c.id;var f=!!a.shiftKey;switch(g){case"idLnkOpenLegal":gl.onShowLegalWindow();break;case"idLnkCopyLegal":var d=chrome.i18n.getMessage("txtLegal");if(d){if(gl.clipboardCopyText(d,true)){c.innerText=gl.encodeHtml(chrome.i18n.getMessage("lnk_done"));setTimeout(function(){c.innerText=gl.encodeHtml(chrome.i18n.getMessage("lnk_copy"))},900)}}break;case"lnkFullScreen":var b=document.getElementById("idVid01");var e=b.src;b.src=e+(e.indexOf("?")==-1?"?":"&")+"autoplay=1";b.req=b.requestFullscreen||b.webkitRequestFullscreen||b.mozRequestFullScreen||b.msRequestFullscreen;if(b.req){b.req()}break;case"lnkContactTranslate":gl.onLinkTranslateContactUs();break;case"lnkFAQPage":case"lnkFAQPage2":gl.openFAQPageIfNotOpened();break;case"lnkContactGeneral":gl.openContactPageIfNotOpened(false);break;case"lnkCollectReport":gl.onLinkCollectBugReport(f);break;case"lnkContactBugs":gl.onLinkBugReportContactUs(f);break;case"idVisitReportBugURL":gl.openURL($("#idReportBugURL").val());break;case"lnkDonate":gl.openURL("http://www.dennisbabkin.com/php/donate.php?id=formalizr");break;default:console.error("[289] Unprocessed link clicked, id="+g);break}},onInitPage:function(){$("#idVer").text(chrome.i18n.getMessage("version_num").replace("#V#",gl.getThisAppVersion()));var f=new Date();var d=f.getFullYear();var a=2014;$("#idCprght").text(chrome.i18n.getMessage("copyright_msg").replace("#Y#",d>a?a.toString()+" - "+d.toString():a.toString()));var b=$("#idOpenSrc");b.html(chrome.i18n.getMessage("openSource").replace("#U#","https://github.com/dennisbabkin/Formalizr"));var c=$("#idDev");c.text("www.dennisbabkin.com");c.attr("href","https://www.dennisbabkin.com/software");c.attr("target","_blank");$("#idCheckUpdts").click(function(h){h.stopPropagation();h.preventDefault();gl.onCheckForUpdates(h.target)});$(".lnkInline").click(function(h){gl.onLinkClicked(this,h)});$("#lnkContactTranslate").attr("href","#");$("#lnkContactTranslate").click(function(h){gl.onLinkClicked(this,h)});$("#idAboutDesc").find("a").each(function(k){var j=$(this);var h=j.attr("href");if(h=="tabManual"){j.attr("href","#");j.click(function(i){i.stopPropagation();i.preventDefault();$("#tabs").tabs({active:gl.getTabIndexByDomID("#"+h)})})}});var g=$("#idVid01");var e=g.attr("src");g.attr("src",e+(e.indexOf("?")==-1?"?":"&")+"rel=0");$("#lnkFAQPage").attr("href","#");$("#lnkFAQPage").click(function(h){gl.onLinkClicked(this,h)});$("#lnkFAQPage2").attr("href","#");$("#lnkFAQPage2").click(function(h){gl.onLinkClicked(this,h)});$("#lnkContactGeneral").attr("href","#");$("#lnkContactGeneral").click(function(h){gl.onLinkClicked(this,h)});$("#lnkCollectReport").attr("href","#");$("#lnkCollectReport").click(function(h){gl.onLinkClicked(this,h)});$("#lnkContactBugs").attr("href","#");$("#lnkContactBugs").click(function(h){gl.onLinkClicked(this,h)});$("#idVisitReportBugURL").attr("title",chrome.i18n.getMessage("prompt_OpenPage"));$("#idVisitReportBugURL").click(function(h){gl.onLinkClicked(this,h)});$("#idReportBugURL").val(gl.getLastVisitedURL());$("#lnkDonate").attr("href","#");$("#lnkDonate").click(function(h){gl.onLinkClicked(this,h)})}};gl.overrideConsole();$("body").hide();gl.localizeHtmlPage();gl.makeNonDraggable();$(function(){chrome.tabs.query({active:true,currentWindow:true},function(c){gl.gnThisTabID=c[0].id;var b=gl.getUrlParams(document.URL);var a=0;if(b.p){var d=gl.getTabIndexByDomID("#"+b.p);if(d!=-1){a=d}}var e=$("#tabs");e.tabs({active:a,activate:function(f,g){gl.onTabSelected(g.newTab.index(),f.shiftKey?true:false)}});gl.onInitPage();$("body").show();gl.onTabSelected(a,false);chrome.tabs.onActivated.addListener(function(f){if(f.tabId==gl.gnThisTabID){gl.updateTabCtrls()}});chrome.windows.onFocusChanged.addListener(function(f){(function(){chrome.windows.getCurrent({populate:false},function(g){if(f==g.id){gl.updateTabCtrls()}})}())})})});